<div id="settings_plugin_LayerCaptureDatacollect">
    <h4>{{ _('Layer Capture Data Collect Settings') }}</h4>
    
    <!-- Plugin Enable/Disable -->
    <div class="control-group">
        <div class="controls">
            <label class="checkbox">
                <input type="checkbox" data-bind="checked: settings.plugins.LayerCaptureDatacollect.enabled">
                {{ _('Enable layer capture') }}
            </label>
            <span class="help-block">{{ _('Enable or disable automatic layer capture during prints') }}</span>
        </div>
    </div>

    <hr>

    <!-- Grid Configuration Section -->
    <h5>{{ _('Grid Configuration') }}</h5>
    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Grid Center X (mm)') }}</label>
                <div class="controls">
                    <div class="input-append">
                        <input type="number" step="0.1" min="0" class="input-mini" 
                               data-bind="value: settings.plugins.LayerCaptureDatacollect.grid_center_x">
                        <span class="add-on">mm</span>
                    </div>
                    <span class="help-block">{{ _('X coordinate of the grid center') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Grid Center Y (mm)') }}</label>
                <div class="controls">
                    <div class="input-append">
                        <input type="number" step="0.1" min="0" class="input-mini" 
                               data-bind="value: settings.plugins.LayerCaptureDatacollect.grid_center_y">
                        <span class="add-on">mm</span>
                    </div>
                    <span class="help-block">{{ _('Y coordinate of the grid center') }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Grid Spacing (mm)') }}</label>
                <div class="controls">
                    <div class="input-append">
                        <input type="number" step="1" min="5" max="100" class="input-mini" 
                               data-bind="value: settings.plugins.LayerCaptureDatacollect.grid_spacing">
                        <span class="add-on">mm</span>
                    </div>
                    <span class="help-block">{{ _('Distance between capture points') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Grid Size') }}</label>
                <div class="controls">
                    <select class="input-small" data-bind="value: settings.plugins.LayerCaptureDatacollect.grid_size">
                        <option value="1">1x1 (1 point)</option>
                        <option value="3">3x3 (9 points)</option>
                        <option value="5">5x5 (25 points)</option>
                    </select>
                    <span class="help-block">{{ _('Number of capture positions in grid') }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">{{ _('Z Offset (mm)') }}</label>
        <div class="controls">
            <div class="input-append">
                <input type="number" step="0.1" min="0" max="20" class="input-mini" 
                       data-bind="value: settings.plugins.LayerCaptureDatacollect.z_offset">
                <span class="add-on">mm</span>
            </div>
            <span class="help-block">{{ _('Height above print surface for capture positions') }}</span>
        </div>
    </div>

    <hr>

    <!-- Capture Settings Section -->
    <h5>{{ _('Capture Settings') }}</h5>
    <div class="control-group">
        <label class="control-label">{{ _('Layer Interval') }}</label>
        <div class="controls">
            <input type="number" step="1" min="1" max="100" class="input-mini" 
                   data-bind="value: settings.plugins.LayerCaptureDatacollect.layer_interval">
            <span class="help-block">{{ _('Capture every N layers (e.g., 3 = capture on layers 3, 6, 9...)') }}</span>
        </div>
    </div>

    <hr>

    <!-- Safety Boundaries Section -->
    <h5>{{ _('Safety Boundaries') }}</h5>
    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Min X (mm)') }}</label>
                <div class="controls">
                    <div class="input-append">
                        <input type="number" step="0.1" class="input-mini" 
                               data-bind="value: settings.plugins.LayerCaptureDatacollect.min_x">
                        <span class="add-on">mm</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Max X (mm)') }}</label>
                <div class="controls">
                    <div class="input-append">
                        <input type="number" step="0.1" class="input-mini" 
                               data-bind="value: settings.plugins.LayerCaptureDatacollect.max_x">
                        <span class="add-on">mm</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Min Y (mm)') }}</label>
                <div class="controls">
                    <div class="input-append">
                        <input type="number" step="0.1" class="input-mini" 
                               data-bind="value: settings.plugins.LayerCaptureDatacollect.min_y">
                        <span class="add-on">mm</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Max Y (mm)') }}</label>
                <div class="controls">
                    <div class="input-append">
                        <input type="number" step="0.1" class="input-mini" 
                               data-bind="value: settings.plugins.LayerCaptureDatacollect.max_y">
                        <span class="add-on">mm</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Max Z (mm)') }}</label>
                <div class="controls">
                    <div class="input-append">
                        <input type="number" step="0.1" min="1" max="500" class="input-mini" 
                               data-bind="value: settings.plugins.LayerCaptureDatacollect.max_z">
                        <span class="add-on">mm</span>
                    </div>
                    <span class="help-block">{{ _('Maximum Z height for capture movements') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <!-- Reserved for future min_z if needed -->
        </div>
    </div>

    <div class="alert alert-info">
        <strong>{{ _('Note:') }}</strong> {{ _('Safety boundaries prevent the print head from moving outside your printer\'s safe area during captures.') }}
    </div>

    <hr>

    <!-- Camera Settings Section -->
    <h5>{{ _('Camera Settings') }}</h5>
    <div class="control-group">
        <div class="controls">
            <label class="checkbox">
                <input type="checkbox" data-bind="checked: settings.plugins.LayerCaptureDatacollect.camera_enabled">
                {{ _('Enable camera capture') }}
            </label>
            <span class="help-block">{{ _('Enable or disable camera functionality') }}</span>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Image Format') }}</label>
                <div class="controls">
                    <select class="input-small" data-bind="value: settings.plugins.LayerCaptureDatacollect.image_format">
                        <option value="jpg">JPEG</option>
                        <option value="png">PNG</option>
                    </select>
                    <span class="help-block">{{ _('Image file format for captures') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Image Quality') }}</label>
                <div class="controls">
                    <input type="number" step="1" min="1" max="100" class="input-mini" 
                           data-bind="value: settings.plugins.LayerCaptureDatacollect.image_quality">
                    <span class="help-block">{{ _('JPEG quality (1-100, higher = better quality)') }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="control-group">
        <div class="controls">
            <label class="checkbox">
                <input type="checkbox" data-bind="checked: settings.plugins.LayerCaptureDatacollect.fake_camera_mode">
                {{ _('Use fake camera for testing') }}
            </label>
            <span class="help-block">{{ _('Enable fake camera mode to test without physical camera hardware') }}</span>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Resolution Width') }}</label>
                <div class="controls">
                    <input type="number" step="1" min="320" max="4096" class="input-small" 
                           data-bind="value: settings.plugins.LayerCaptureDatacollect.camera_resolution_x">
                    <span class="help-block">{{ _('Camera resolution width in pixels') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Resolution Height') }}</label>
                <div class="controls">
                    <input type="number" step="1" min="240" max="3072" class="input-small" 
                           data-bind="value: settings.plugins.LayerCaptureDatacollect.camera_resolution_y">
                    <span class="help-block">{{ _('Camera resolution height in pixels') }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('ISO Setting') }}</label>
                <div class="controls">
                    <select class="input-small" data-bind="value: settings.plugins.LayerCaptureDatacollect.camera_iso">
                        <option value="100">ISO 100</option>
                        <option value="200">ISO 200</option>
                        <option value="400">ISO 400</option>
                        <option value="800">ISO 800</option>
                    </select>
                    <span class="help-block">{{ _('Camera ISO sensitivity') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Rotation') }}</label>
                <div class="controls">
                    <select class="input-small" data-bind="value: settings.plugins.LayerCaptureDatacollect.camera_rotation">
                        <option value="0">0°</option>
                        <option value="90">90°</option>
                        <option value="180">180°</option>
                        <option value="270">270°</option>
                    </select>
                    <span class="help-block">{{ _('Camera rotation in degrees') }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">{{ _('Shutter Speed (μs)') }}</label>
        <div class="controls">
            <input type="number" step="1000" min="0" max="6000000" class="input-medium" 
                   data-bind="value: settings.plugins.LayerCaptureDatacollect.camera_shutter_speed"
                   placeholder="0 (auto)">
            <span class="help-block">{{ _('Camera shutter speed in microseconds (0 = automatic)') }}</span>
        </div>
    </div>

    <!-- Advanced Camera Controls (camera-streamer inspired) -->
    <hr>
    <h4>{{ _('Advanced Camera Controls') }}</h4>
    <p class="help-block">{{ _('Modern camera controls inspired by camera-streamer for enhanced image quality') }}</p>

    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Exposure Mode') }}</label>
                <div class="controls">
                    <select class="input-medium" data-bind="value: settings.plugins.LayerCaptureDatacollect.exposure_mode">
                        <option value="auto">{{ _('Automatic') }}</option>
                        <option value="manual">{{ _('Manual') }}</option>
                    </select>
                    <span class="help-block">{{ _('Automatic or manual exposure control') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('White Balance') }}</label>
                <div class="controls">
                    <select class="input-medium" data-bind="value: settings.plugins.LayerCaptureDatacollect.white_balance_mode">
                        <option value="auto">{{ _('Automatic') }}</option>
                        <option value="daylight">{{ _('Daylight') }}</option>
                        <option value="tungsten">{{ _('Tungsten') }}</option>
                        <option value="fluorescent">{{ _('Fluorescent') }}</option>
                    </select>
                    <span class="help-block">{{ _('White balance mode for different lighting conditions') }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Brightness') }}</label>
                <div class="controls">
                    <input type="number" step="0.1" min="-1.0" max="1.0" class="input-small" 
                           data-bind="value: settings.plugins.LayerCaptureDatacollect.brightness"
                           placeholder="0.0">
                    <span class="help-block">{{ _('Brightness adjustment (-1.0 to 1.0)') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Contrast') }}</label>
                <div class="controls">
                    <input type="number" step="0.1" min="0.0" max="2.0" class="input-small" 
                           data-bind="value: settings.plugins.LayerCaptureDatacollect.contrast"
                           placeholder="1.0">
                    <span class="help-block">{{ _('Contrast adjustment (1.0 = normal)') }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Saturation') }}</label>
                <div class="controls">
                    <input type="number" step="0.1" min="0.0" max="2.0" class="input-small" 
                           data-bind="value: settings.plugins.LayerCaptureDatacollect.saturation"
                           placeholder="1.0">
                    <span class="help-block">{{ _('Color saturation (1.0 = normal)') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Sharpness') }}</label>
                <div class="controls">
                    <input type="number" step="0.1" min="0.0" max="2.0" class="input-small" 
                           data-bind="value: settings.plugins.LayerCaptureDatacollect.sharpness"
                           placeholder="1.0">
                    <span class="help-block">{{ _('Image sharpness (1.0 = normal)') }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Noise Reduction') }}</label>
                <div class="controls">
                    <select class="input-medium" data-bind="value: settings.plugins.LayerCaptureDatacollect.noise_reduction_mode">
                        <option value="auto">{{ _('Automatic') }}</option>
                        <option value="off">{{ _('Off') }}</option>
                        <option value="fast">{{ _('Fast') }}</option>
                        <option value="high_quality">{{ _('High Quality') }}</option>
                    </select>
                    <span class="help-block">{{ _('Noise reduction algorithm') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <div class="controls">
                    <label class="checkbox">
                        <input type="checkbox" data-bind="checked: settings.plugins.LayerCaptureDatacollect.enable_image_processing">
                        {{ _('Enable Image Processing') }}
                    </label>
                    <span class="help-block">{{ _('Enable post-capture image processing') }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="control-group">
        <div class="controls">
            <label class="checkbox">
                <input type="checkbox" data-bind="checked: settings.plugins.LayerCaptureDatacollect.auto_enhance">
                {{ _('Auto Enhancement') }}
            </label>
            <span class="help-block">{{ _('Automatically enhance images with subtle improvements') }}</span>
        </div>
    </div>

    <hr>

    <!-- Advanced Settings Section -->
    <h5>{{ _('Advanced Settings') }}</h5>
    <div class="row-fluid">
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Move Speed (mm/min)') }}</label>
                <div class="controls">
                    <div class="input-append">
                        <input type="number" step="100" min="500" max="6000" class="input-small" 
                               data-bind="value: settings.plugins.LayerCaptureDatacollect.move_speed">
                        <span class="add-on">mm/min</span>
                    </div>
                    <span class="help-block">{{ _('Speed for positioning moves during capture') }}</span>
                </div>
            </div>
        </div>
        <div class="span6">
            <div class="control-group">
                <label class="control-label">{{ _('Capture Delay (seconds)') }}</label>
                <div class="controls">
                    <div class="input-append">
                        <input type="number" step="0.1" min="0" max="5" class="input-mini" 
                               data-bind="value: settings.plugins.LayerCaptureDatacollect.capture_delay">
                        <span class="add-on">s</span>
                    </div>
                                <span class="help-block">{{ _('Delay after positioning before taking photo') }}</span>
        </div>
    </div>
</div>

<div class="control-group">
    <div class="controls">
        <label class="checkbox">
            <input type="checkbox" data-bind="checked: settings.plugins.LayerCaptureDatacollect.enable_movement">
            {{ _('Enable Print Head Movement') }}
        </label>
        <span class="help-block">{{ _('Enable actual print head movement during captures (disable for testing without moving)') }}</span>
    </div>
</div>


    </div>

    <hr>

    <!-- File Paths Section -->
    <h5>{{ _('File Paths') }}</h5>
    <div class="control-group">
        <label class="control-label">{{ _('Save Path') }}</label>
        <div class="controls">
            <input type="text" class="input-xxlarge" 
                   data-bind="value: settings.plugins.LayerCaptureDatacollect.save_path"
                   placeholder="~/.octoprint/uploads/layer_captures">
            <span class="help-block">{{ _('Directory where captured images and metadata will be saved') }}</span>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">{{ _('Calibration File Path') }}</label>
        <div class="controls">
            <input type="text" class="input-xxlarge" 
                   data-bind="value: settings.plugins.LayerCaptureDatacollect.calibration_file_path"
                   placeholder="/path/to/calibration.json">
            <span class="help-block">{{ _('Path to the calibration file for camera positioning (optional)') }}</span>
        </div>
    </div>

    <hr>

    <!-- Status and Actions Section -->
    <h5>{{ _('Status & Actions') }}</h5>
    <div class="control-group">
        <div class="controls">
            <button class="btn btn-small" data-bind="click: testCamera">
                <i class="fa fa-camera"></i> {{ _('Test Camera') }}
            </button>
            <button class="btn btn-small" data-bind="click: captureNow, enable: isPrinting">
                <i class="fa fa-photo"></i> {{ _('Capture Now') }}
            </button>
            <button class="btn btn-small" data-bind="click: getStatus">
                <i class="fa fa-info-circle"></i> {{ _('Get Status') }}
            </button>
            <button class="btn btn-small" data-bind="click: testPaths">
                <i class="fa fa-folder-open"></i> {{ _('Test Paths') }}
            </button>
        </div>
    </div>

    <!-- Status Display -->
    <div class="control-group" data-bind="visible: statusMessage">
        <div class="controls">
            <div class="alert" data-bind="css: {'alert-success': statusSuccess, 'alert-error': !statusSuccess()}, text: statusMessage">
            </div>
        </div>
    </div>

    <!-- Grid Preview -->
    <div class="control-group">
        <label class="control-label">{{ _('Grid Preview') }}</label>
        <div class="controls">
            <div id="grid-preview" style="width: 300px; height: 200px; border: 1px solid #ccc; position: relative; background: #f9f9f9;">
                <div style="position: absolute; top: 10px; left: 10px; font-size: 10px; color: #666;">
                    {{ _('Print bed visualization') }}
                </div>
                <!-- Grid points will be dynamically added here via JavaScript -->
            </div>
            <span class="help-block">{{ _('Visual representation of capture grid on your print bed') }}</span>
        </div>
    </div>
</div> 